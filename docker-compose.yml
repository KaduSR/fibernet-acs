services:
  cwmp:
    build: .  # <--- A MÁGICA ESTÁ AQUI: Constrói localmente
    restart: always
    command: genieacs-cwmp
    environment: &genieacs_env
      GENIEACS_MONGODB_CONNECTION_URL: mongodb://mongo/genieacs
      GENIEACS_REDIS_PORT: 6379
      GENIEACS_REDIS_HOST: redis
      GENIEACS_UI_JWT_SECRET: FiberNetSecretKey2025
      GENIEACS_CWMP_ACCESS_LOG_FILE: /dev/stdout
      GENIEACS_NBI_ACCESS_LOG_FILE: /dev/stdout
      GENIEACS_UI_ACCESS_LOG_FILE: /dev/stdout
      GENIEACS_DEBUG_FILE: /dev/stdout
      GENIEACS_EXT_DIR: /opt/genieacs/ext
    external_links:
      - mongo
      - redis

  nbi:
    build: .
    restart: always
    command: genieacs-nbi
    environment: *genieacs_env

  fs:
    build: .
    restart: always
    command: genieacs-fs
    environment: *genieacs_env

  ui:
    build: .
    restart: always
    command: genieacs-ui
    environment: *genieacs_env
